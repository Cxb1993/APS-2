\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}

\graphicspath{{images/}}
%\usepackage[top=2cm,bottom=2cm,left=1.5cm,right=1.5cm]{geometry}
%opening
\title{Advection Tests}
\author{Palas Kumar Farsoiya}

\begin{document}

\maketitle

\begin{abstract}
Volume of Fluid method is validated by chosing three test cases from \cite{Rudman1997}, 
\begin{enumerate}
 \item Circle in translational flow
 \item Solid body rotation of slotted circle
 \item Circle in shear flow
\end{enumerate}

\end{abstract}



\begin{figure}[H]
 
  \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{CD_0.eps}
 \caption{Initial Condition for density field}
 \end{subfigure}
 \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{CD_20.eps}
 \caption{After advecting density for 20 time steps}
 \end{subfigure}
 \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{CD_50.eps}
 \caption{After advecting density for 50 time steps}
 \end{subfigure}
  \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{CD_100.eps}
 \caption{After advecting density for 100 time steps}
 \end{subfigure}
 \caption{Advection density using finite difference method}
\end{figure}

\section{Advection of circle in translational flow}
The algorithm is tested for the simplest case of unidirectional velocity field. Two concentric circles are used as the initial 
condition for translational test, with center at (0.75,1) and diameter of inner and outer circle is 0.4 and 0.8 respectively (Fig. 1).
The volume fraction thus generated by the configuration of concentric circles is of a hollow circle. The volume fraction scalar
field is advected by two velocity fields U(1,0) and U(2,1). The refinement of the domain which is $4.0X4.0$ is $200X200$. The time
step is 0.005 and advection proceeds for 500 and 504 steps for case 1 and case 2 respectively.

\begin{figure}[H]
 \centering
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{IC.eps}
 \caption{Initial Condition for translational test}
 \end{subfigure}
  \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{final500.eps}
 \caption{After advecting 500 steps}
 \end{subfigure}
 \caption{Advection test for velocity field U(1,0)}
\end{figure}

\begin{figure}[H]
 \centering
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{IC21.eps}
 \caption{Initial Condition for translational test}
 \end{subfigure}
  \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{final504.eps}
 \caption{After advecting 504 steps}
 \end{subfigure}
 \caption{Advection test for velocity field U(2,1)}
\end{figure}

\section{Advection test for solid body rotation}
For solid body rotation test a slotted circle configuration is taken from \cite{zalesk1979}, the center of slotted circle is at
(2.0,2.75) and diameter is 1.0. The length and width of slot is 0.6 and 0.12 respectively.(Fig. 3(a))  The refinement of the domain which is $4.0X4.0$ is $200X200$.
A curl free velocity field is given by $U(-\Omega(y-y_0),\Omega(x-x_0))$, where axis of rotation passes through the $(x_0,y_0)$ and normal to the x-y plane. $\Omega$ is 
the angular velocity. Here $\Omega = 0.5$ and $(x_0,y_0)$ is $(2,2)$. The time step is 0.005.


\begin{figure}[H]
 \centering
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{SC_IC.eps}
 \caption{Initial Condition for solid body rotation test.}
 \end{subfigure}
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{SC_2513.eps}
 \caption{After full rotation}
 \end{subfigure}
 \caption{Comparison with \cite{Rudman1997} results. (Red LVIRA and Black \cite{Rudman1997} data)}
\end{figure}

\begin{figure}[H]
 
  \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{SC_628.eps}
 \caption{After advecting 628 steps}
 \end{subfigure}
 \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{SC_1256.eps}
 \caption{After advecting 1256 steps}
 \end{subfigure}
 \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{SC_1885.eps}
 \caption{After advecting 1885 steps}
 \end{subfigure}
  \begin{subfigure}[p]{0.5\textwidth}
 \includegraphics[width=\textwidth]{SC_2513O.eps}
 \caption{After advecting 2513 steps.}
 \end{subfigure}
 \caption{Advection test result for solid body rotation}
\end{figure}

\section{Shear Test}
The real problems typically encounters the interface deformation, which includes merging and deformation. Hence the algorithm has to be 
tested for shear velocity field. The velocity field is given by $U(sin x cos y, -cos x sin y)$. The domain size is given by $\pi X \pi$ and refinement
is $100 X 100$. A circle of radius $\pi/5$ and center at $(\pi/2,\pi/4)$ was advected in the velocity field for 1000 steps forward and 1000 steps backward 
by reversing the signs of velocity field. 


\begin{figure}[H]
\centering
	\begin{subfigure}[p]{0.4\textwidth}
      \includegraphics[width=\textwidth]{shear_IC.eps}
      \caption{Initial condition for shear test.}
      \end{subfigure}
      \begin{subfigure}[p]{0.4\textwidth}
      \includegraphics[width=\textwidth]{shear_250.eps}
      \caption{After advecting 250 steps}
      \end{subfigure}
      \begin{subfigure}[p]{0.4\textwidth}
      \includegraphics[width=\textwidth]{shear_500.eps}
      \caption{After advecting 500 steps}
      \end{subfigure}
      \begin{subfigure}[p]{0.4\textwidth}
      \includegraphics[width=\textwidth]{shear_1000.eps}
      \caption{After advecting 1000 steps}
      \end{subfigure}

 \caption{Advection test result for shear velocity field}
\end{figure}


\begin{figure}[H]
 \centering
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{shear_1000c.eps}
 \caption{After 1000 steps forward}
 \end{subfigure}
 \begin{subfigure}[p]{1.0\textwidth}
 \includegraphics[width=\textwidth]{shear_back.eps}
 \caption{1000 steps backward followed by 1000 steps forward}
 \end{subfigure}
 \caption{Comparison with \cite{Gerlach2006} results. (Red LVIRA and Black \cite{Gerlach2006} data)}
\end{figure}

\section{Calculation of error}
The above results can be quantified by defining the error by
\begin{equation}
 E = \frac{\sum |{V^n_{i,j}-V^e_{i,j}}|}{\sum V^0_{i,j}}
\end{equation}

where $V^n$ is the solution of volume fraction field after n time steps by computation, $V^e$ is the exact solution, and $V^0$ is the initial solution. The initial solution can be calculated by the initial 
volume fraction field, exact solution of fields for translational fields can be easily calculated by recreating the circle at the center which has moved with the velocity field. For solid body
rotation the exact solution is equals to the initial solution after one full rotation. For shear after 1000 backward steps the final solution should also be equal to initial solution.

\begin{table}[H]
  \begin{center}
    \caption{Error for various tests}
    \label{tab:samtab}
    \begin{tabular}{p{3cm}lllll}
      \toprule 
       Test & SLIC & Hirt-Nichols & FCT-VOF & Youngs & LVIRA  \\ 
      \midrule
      Translational (V(1,0)) & $1.30 X 10^{-2}$ & $4.55 X 10^{-2}$ & $1.28 X 10^{-2}$ & $3.08 X 10^{-3}$ & $1.5 X 10^{-3}$  \\ 
        Translational (V(2,1)) & $9.18 X 10^{-2}$ & $1.9 X 10^{-1}$ & $3.99 X 10^{-2}$ & $2.98 X 10^{-2}$ & $1.05 X 10^{-2}$  \\ 
      Shear Flow & $4.59 X 10^{-2}$ & $6.66 X 10^{-2}$ & $3.14 X 10^{-2}$ & $8.60 X 10^{-3}$ & $6.90 X 10^{-3}$  \\ 
       Solid Body Rotation (Slotted circle) & $8.38 X 10^{-2}$ & $9.62 X 10^{-2}$ & $3.29 X 10^{-2}$ & $1.09 X 10^{-2}$ & $9.7 X 10^{-3}$  \\ 
        
      \bottomrule \\
    \end{tabular}
  \end{center}
\end{table}

\end{document}
